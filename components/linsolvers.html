

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage &mdash; pressio-rom-0.17.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/hacks.css?v=c7976331" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=0c3dd48d"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="License" href="../license.html" />
    <link rel="prev" title="example 1" href="nonlinsolvers_examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pressio-rom
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../keywords.html">CMake Keywords</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ROMs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rom_concepts.html">Concepts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ODE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ode_concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode_examples.html">example 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode_examples.html#example-2">example 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="ode_examples.html#example-3">example 3</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Nonlinear solvers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nonlinsolvers_newton.html">Newton-Raphson</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinsolvers_enums.html">Enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinsolvers_examples.html">example 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinsolvers_examples.html#example-2">example 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Linear solvers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">Usage</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellanea</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Pressio/pressio-ops">GitHub Repo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Pressio/pressio-ops/issues">Open an issue/feature req.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pressio-rom</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">Usage</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/components/linsolvers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usage">
<h1><code class="docutils literal notranslate"><span class="pre">Usage</span></code><a class="headerlink" href="#usage" title="Link to this heading"></a></h1>
<p>Header <code class="docutils literal notranslate"><span class="pre">&lt;pressio/solvers_linear.hpp&gt;</span></code></p>
<p>Public namespace: <code class="docutils literal notranslate"><span class="pre">pressio::linearsolvers</span></code></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>We clearly state upfront that this component of pressio
is not a self-contained, general purpose library of linear solvers
implemented from scratch.
In the future, we might revise this, but for now it is
an <strong>intentional</strong> choice: there exist already many
open-source highly-optimized libraries that provide linear solvers
for both shared-memory, e.g. Armadillo, Eigen, Blaze, Magma, LAPACK,
and distributed environment, e.g. Trilinos, PETSc, HYPRE.</p>
<p><strong>The primary goal of the pressio’s linear solvers is to support usecases that are needed for ROMs.
As discussed in the introduction, ROMs involve “small”
dense systems that suitably fit on a single compute node.
Pressio’s linear solvers are thus designed and implemented to be
wrappers (exposing a common interface) to existing shared-memory
linear solvers libraries.</strong></p>
<p>Currently, we support linear systems using either
Eigen or Kokkos containers. The reason for this is that Eigen
and Kokkos are the supported and preferred choices (for now)
to implement ROMs operators. Kokkos, in particular, allows
to operate both on host and GPUs.
Later on, we can easily extend support to other libraries if needed.
Note that even if the scope of the linear solvers is limited,
we still emphasize that, like all of the others subpackages in pressio,
it can be used idenpendetly.</p>
<section id="why-do-we-need-it">
<h3>Why do we need it?<a class="headerlink" href="#why-do-we-need-it" title="Link to this heading"></a></h3>
<p>todo: explain that we need to a uniform interface.</p>
</section>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Link to this heading"></a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">pressio</span><span class="o">::</span><span class="n">linearsolvers</span><span class="o">::</span><span class="n">Solver</span><span class="o">&lt;</span><span class="n">Tag</span><span class="p">,</span><span class="w"> </span><span class="n">MatrixType</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Tag</span></code>: tag type specifying which type of solver to use (more on this below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MatrixType</span></code>: data type of the matrix of the linear system to solve
(used to choose the proper specialization).</p></li>
</ul>
<p>We distinguish between iterative and direct solvers.
Obviously, depending on the structure of the matrix, some methods
might not be applicable or might not be efficient.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tag</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Works for:</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iterative::CG</span></code></p></td>
<td><p>Conjugate-gradient</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iterative::Bicgstab</span></code></p></td>
<td><p>Biconjugate gradient stabilized</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iterative::LSCG</span></code></p></td>
<td><p>Conjugate-gradient</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">direct::HouseholderQR</span></code></p></td>
<td><p>Uses on householder QR</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">direct::ColPivHouseholderQR</span></code></p></td>
<td><p>Uses on Householder QR with pivoting</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">direct::PartialPivLU</span></code></p></td>
<td><p>Uses LU factorization with partial pivoting</p></td>
<td><p>Eigen</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">direct::potrsL</span></code></p></td>
<td><p>Uses Cholesky, lower part</p></td>
<td><p>Kokkos</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">direct::potrsU</span></code></p></td>
<td><p>Uses Cholesky, upper part</p></td>
<td><p>Kokkos</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">direct::getrs</span></code></p></td>
<td><p>Uses LU factorization</p></td>
<td><p>Kokkos</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">direct::geqrf</span></code></p></td>
<td><p>Uses QR fatorization</p></td>
<td><p>Kokkos</p></td>
</tr>
</tbody>
</table>
</section>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading"></a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">MatrixType</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LinearSolver</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">matrix_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MatrixType</span><span class="p">;</span>

<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">StateType</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">RhsType</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MatrixType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">RhsType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">StateType</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
<section id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h2>
<p>todo: need to discuss difference between iterative and direct</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//</span>
<span class="c1">// we want to solve `Ax = b`</span>
<span class="c1">//</span>

<span class="k">using</span><span class="w"> </span><span class="n">matrix_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="n">vector_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">VectorXd</span><span class="p">;</span>
<span class="n">matrix_type</span><span class="w"> </span><span class="nf">A</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="c1">// fill A</span>
<span class="n">vector_type</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="c1">// fill b</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">pls</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nn">pressio</span><span class="o">::</span><span class="nn">linearsolvers</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="n">tag</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">pls</span><span class="o">::</span><span class="n">direct</span><span class="o">::</span><span class="n">HouseholderQr</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="n">solver_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pls</span><span class="o">::</span><span class="n">Solver</span><span class="o">&lt;</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">matrix_type</span><span class="o">&gt;</span><span class="p">;</span>
<span class="n">solver</span><span class="w"> </span><span class="n">mySolver</span><span class="p">;</span>
<span class="n">vector_type</span><span class="w"> </span><span class="nf">x</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="n">mySolver</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nonlinsolvers_examples.html" class="btn btn-neutral float-left" title="example 1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS).
      <span class="lastupdated">Last updated on Sep 04, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>